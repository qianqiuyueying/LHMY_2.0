<!--pages/entitlement/entitlement.wxml-->
<view class="container">
  <!-- 筛选栏 -->
  <view class="filter-bar">
    <view class="filter-group">
      <text class="filter-label">类型：</text>
      <text 
        class="filter-item {{typeFilter === null ? 'active' : ''}}"
        bindtap="onTypeFilterTap"
        data-type="{{null}}"
      >
        全部
      </text>
      <text 
        class="filter-item {{typeFilter === 'SERVICE_PACKAGE' ? 'active' : ''}}"
        bindtap="onTypeFilterTap"
        data-type="SERVICE_PACKAGE"
      >
        服务包
      </text>
    </view>
    <view class="filter-group">
      <text class="filter-label">状态：</text>
      <text 
        class="filter-item {{statusFilter === null ? 'active' : ''}}"
        bindtap="onStatusFilterTap"
        data-status="{{null}}"
      >
        全部
      </text>
      <text 
        class="filter-item {{statusFilter === 'ACTIVE' ? 'active' : ''}}"
        bindtap="onStatusFilterTap"
        data-status="ACTIVE"
      >
        可用
      </text>
      <text 
        class="filter-item {{statusFilter === 'USED' ? 'active' : ''}}"
        bindtap="onStatusFilterTap"
        data-status="USED"
      >
        已用
      </text>
      <text 
        class="filter-item {{statusFilter === 'EXPIRED' ? 'active' : ''}}"
        bindtap="onStatusFilterTap"
        data-status="EXPIRED"
      >
        已过期
      </text>
    </view>
  </view>

  <!-- 权益列表 -->
  <view class="entitlements-list">
    <view 
      class="entitlement-card card"
      wx:for="{{entitlements}}"
      wx:key="id"
      data-id="{{item.id}}"
      bindtap="onEntitlementTap"
    >
      <view class="entitlement-header">
        <text class="entitlement-type">服务包</text>
        <text class="entitlement-status {{item.status === 'ACTIVE' ? 'active' : ''}}">
          {{item.status === 'ACTIVE' ? '可用' : item.status === 'USED' ? '已用' : item.status === 'EXPIRED' ? '已过期' : '已退款'}}
        </text>
      </view>
      <text class="entitlement-service">{{item.serviceType}}</text>
      <view class="entitlement-count">
        <text>剩余次数：{{item.remainingCount}}/{{item.totalCount}}</text>
      </view>
      <view class="entitlement-validity">
        <text>有效期：{{item.validFrom}} ~ {{item.validUntil}}</text>
      </view>
      <view class="entitlement-actions">
        <button class="btn btn-primary" wx:if="{{item.status === 'ACTIVE'}}">查看详情</button>
      </view>
    </view>
  </view>

  <view class="empty-state" wx:if="{{!loading && entitlements.length === 0}}">
    <text>暂无权益</text>
  </view>
</view>
