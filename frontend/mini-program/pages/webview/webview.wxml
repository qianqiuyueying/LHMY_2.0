<!-- pages/webview/webview.wxml -->
<view class="container">
  <!-- 注意：web-view 必须真实渲染出来才能触发 bindload/binderror。
       不能用 wx:if="{{loading}}" 把 web-view 隐藏掉，否则会出现“永远加载中→超时→无法打开”的假象。 -->
  <web-view
    wx:if="{{url}}"
    src="{{url}}"
    bindload="onWebViewLoad"
    binderror="onWebViewError"
  ></web-view>

  <!-- overlay：使用 cover-view 才能覆盖在 web-view 上方 -->
  <cover-view class="state-wrap" wx:if="{{loading}}">
    <cover-view class="state-card">
      <cover-view class="state-graphic"></cover-view>
      <cover-view class="state-title">加载中</cover-view>
      <cover-view class="state-desc">正在打开页面…</cover-view>
    </cover-view>
  </cover-view>

  <cover-view class="state-wrap" wx:elif="{{errorMessage}}">
    <cover-view class="state-card">
      <cover-view class="state-graphic"></cover-view>
      <cover-view class="state-title">无法打开</cover-view>
      <cover-view class="state-desc">{{errorMessage}}</cover-view>
      <cover-view class="state-actions">
        <cover-view class="btn btn-primary" bindtap="onRetryTap">重试</cover-view>
        <cover-view class="btn btn-ghost" bindtap="onBackTap">返回</cover-view>
      </cover-view>
    </cover-view>
  </cover-view>
</view>
