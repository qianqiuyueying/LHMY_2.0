<!-- pages/support/support.wxml -->
<view class="container">
  <view class="state-wrap" wx:if="{{loading}}">
    <view class="state-card">
      <view class="state-graphic"></view>
      <view class="state-title">加载中</view>
      <view class="state-desc">正在获取帮助内容…</view>
    </view>
  </view>

  <view class="state-wrap" wx:elif="{{errorMessage}}">
    <view class="state-card">
      <view class="state-graphic"></view>
      <view class="state-title">加载失败</view>
      <view class="state-desc">{{errorMessage}}</view>
      <view class="state-actions">
        <button class="btn btn-primary" bindtap="loadFaq">重试</button>
        <button class="btn btn-ghost" bindtap="onBackTap">返回</button>
      </view>
    </view>
  </view>

  <view wx:else class="content">
    <view class="card">
      <view class="section-title">常见问题</view>
      <view wx:if="{{items.length === 0}}" class="empty-hint">
        暂无常见问题内容
      </view>
      <view wx:else>
        <view
          class="faq-item"
          wx:for="{{items}}"
          wx:key="index"
          data-index="{{index}}"
          bindtap="onToggleItem"
        >
          <view class="faq-q">
            <text class="q-text">{{item.q}}</text>
            <text class="q-action">{{openIndex === index ? '收起' : '展开'}}</text>
          </view>
          <view class="faq-a" wx:if="{{openIndex === index}}">
            <text class="a-text">{{item.a}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="card">
      <view class="section-title">反馈与排障</view>
      <view class="section-desc">
        如果遇到页面空白、加载失败、支付失败等问题，可先复制诊断信息并提供给研发/运营。
      </view>
      <view class="actions">
        <button class="btn btn-ghost" open-type="contact">联系在线客服</button>
        <button class="btn btn-primary" bindtap="onCopyDiagnostics">复制诊断信息</button>
      </view>
    </view>
  </view>
</view>
