## 后端升级需求与变更清单（v1，最小）

> 说明：本文件用于承载“后端维护性升级”的需求编号与验收口径。  
> 目前仅补齐代码中已引用的需求编号，避免规格入口缺失。

### REQ-P0-001：微信支付回调 Webhook

- **目标**：支持微信支付 v3 通知回调：验签 + 解密 + 订单入账。
- **接口**：`POST /api/v1/payments/wechat/notify`
- **验收口径（最小）**
  - 回调请求验签失败：按微信协议返回 `{code:"FAIL", message:"..."}`（非 2xx 会触发微信重试）
  - 回调验签与解密成功：能根据 `out_trade_no`（Order.id）找到 Payment，并触发入账逻辑
  - 幂等：重复回调不会导致重复入账（由状态机/幂等逻辑兜底）
- **证据入口**
  - API：`backend/app/api/v1/payments.py` `wechat_pay_notify()`
  - 业务入账：`backend/app/services/payment_callbacks.py` `mark_payment_succeeded()`


